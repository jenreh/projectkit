// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/python
{
	"name": "ProjectKit-App",
	"dockerComposeFile": "docker-compose.yml",
	"service": "app",
	"remoteUser": "vscode",
	"workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",
	"containerEnv": {
		"WORKSPACE": "/workspaces/${localWorkspaceFolderBasename}"
	},
	"mounts": [
		"source=${localEnv:HOME}${env:USERPROFILE}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
	],
	"customizations": {
		"vscode": {
			"settings": {
				"python.defaultInterpreterPath": "/usr/local/bin/python",
				"python.envFile": "${workspaceFolder}/.env"
			},
			"extensions": [
				"-dbaeumer.vscode-eslint",
				"-ms-python.autopep8", // disabled because we are using ruff
				"charliermarsh.ruff",
				"esbenp.prettier-vscode",
				"fill-labs.dependi",
				"GitHub.copilot-chat",
				"GitHub.copilot",
				"GitHub.remotehub",
				"github.vscode-github-actions",
				"GitHub.vscode-pull-request-github",
				"humao.rest-client",
				"ms-azuretools.vscode-azureterraform",
				"ms-azuretools.vscode-docker",
				"ms-ossdata.vscode-pgsql",
				"ms-python.mypy-type-checker",
				"ms-python.python",
				"mutantdino.resourcemonitor",
				"naumovs.color-highlight",
				"redhat.vscode-yaml",
				"sndst00m.vscode-native-svg-preview",
				"tamasfe.even-better-toml",
				"teticio.python-envy",
				"Upstash.context7-mcp",
				"vscode-icons-team.vscode-icons",
				"yzhang.markdown-all-in-one"
				//				"ms-azuretools.vscode-containers",
			]
		}
	},
	"features": {
		"ghcr.io/devcontainers/features/common-utils:2.5.5": {
			"configureZshAsDefaultShell": true,
			"username": "vscode"
		},
		"ghcr.io/devcontainers/features/git:1.3.4": {},
		// "ghcr.io/devcontainers/features/git-lfs:1.2.5": {},
		"ghcr.io/devcontainers/features/docker-outside-of-docker:1.6.5": {},
		"ghcr.io/devcontainers/features/github-cli:1.0.15": {},
		// "ghcr.io/devcontainers/features/azure-cli:1.2.8": {},
		// "ghcr.io/devcontainers/features/terraform:1.4.2": {
		//    "installTerraformDocs": "true",
		//	  "installTFsec": "true"
		// },
		"ghcr.io/jsburckhardt/devcontainer-features/uv:1": {},
		"ghcr.io/devcontainers/features/node:1": {
			"version": "24"
		}
	},
	"postCreateCommand": {
		"initialize environment": "bash ./.devcontainer/post-create.sh"
	},
	"postAttachCommand": {
		"install dependencies": "uv sync"
	}
}
